<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unicorn Jumper – Reachable Rings</title>
<style>
  body { margin:0; background:linear-gradient(to top,#c6f0ff,#ffffff); overflow:hidden; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
  canvas { display:block; background:linear-gradient(to top,#87cefa,#ffffff); }
  .hud{position:fixed;left:12px;top:12px;background:rgba(0,0,0,.45);color:#fff;border-radius:10px;padding:8px 12px;font-size:14px}
  .hint{position:fixed;right:12px;top:12px;background:rgba(0,0,0,.45);color:#fff;border-radius:10px;padding:8px 12px;font-size:13px}
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div class="hud">Score: <span id="score">0</span></div>
<div class="hint">Tap / Space to jump • Hold to jump higher • Double jump enabled</div>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
addEventListener('resize', resize); resize();

let unicorn = {
  x: 60,
  y: canvas.height - 150,
  w: 80, h: 80,
  dy: 0,
  gravity: 0.65,      // lighter gravity for higher arc
  jumpPower: -18,     // stronger jump
  grounded: false,
  canDouble: true,    // allows one extra jump in air
  jumping: false      // for variable jump height
};

let clouds = [];
let rings = [];
let fireballs = [];
let score = 0;
let gameOver = false;
let spaceHeld = false;

// Simple visuals (hosted images kept to avoid heavy base64)
const unicornImg = new Image(); unicornImg.src = 'https://i.ibb.co/q9VZPt7/unicorn.png';
const cloudImg   = new Image(); cloudImg.src   = 'https://i.ibb.co/n8b02q1/cloud.png';
const ringImg    = new Image(); ringImg.src    = 'https://i.ibb.co/b1b8dYV/coin.png';
const fireImg    = new Image(); fireImg.src    = 'https://i.ibb.co/6tn5ZBd/fireball.png';

// clouds
for(let i=0;i<6;i++){
  clouds.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height*0.45+canvas.height*0.1, w: 160, h: 60, s: 0.5+Math.random()*0.8 });
}

// INPUT
function tryJump(){
  // initial jump
  if(unicorn.grounded){
    unicorn.dy = unicorn.jumpPower;
    unicorn.grounded = false;
    unicorn.canDouble = true;
    unicorn.jumping = true;
    return;
  }
  // double jump
  if(unicorn.canDouble){
    unicorn.dy = unicorn.jumpPower * 0.9; // slightly weaker second jump
    unicorn.canDouble = false;
    unicorn.jumping = true;
  }
}
function endJump(){
  unicorn.jumping = false;
}

addEventListener('keydown', e=>{
  if(e.code === 'Space'){ if(!spaceHeld){ tryJump(); } spaceHeld = true; }
});
addEventListener('keyup', e=>{
  if(e.code === 'Space'){ spaceHeld = false; endJump(); }
});
addEventListener('touchstart', e=>{ e.preventDefault(); tryJump(); spaceHeld = true; }, {passive:false});
addEventListener('touchend',   e=>{ e.preventDefault(); spaceHeld = false; endJump(); }, {passive:false});

// Spawners
function spawnRing(){
  // Reachable band: 35%–70% of screen height
  const y = Math.random()*(canvas.height*0.35) + canvas.height*0.35;
  rings.push({ x: canvas.width + 50, y, w: 40, h: 40, s: 4 });
}
function spawnFireball(){
  const y = Math.random()*(canvas.height*0.5) + canvas.height*0.2;
  fireballs.push({ x: canvas.width + 50, y, w: 40, h: 40, s: 6 });
}
let ringTimer = 0, fireTimer = 0;

function update(dt){
  // bg
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // parallax clouds
  clouds.forEach(c=>{
    c.x -= c.s;
    if(c.x + c.w < -40){ c.x = canvas.width + 80; c.y = Math.random()*canvas.height*0.45+canvas.height*0.1; c.s = 0.5+Math.random()*0.8; }
    ctx.drawImage(cloudImg, c.x, c.y, c.w, c.h);
  });

  // physics: variable jump height (hold to go higher)
  // while going up (dy<0) and jump is held, reduce gravity effect
  let effectiveGravity = unicorn.gravity;
  if(unicorn.dy < 0 && spaceHeld){ effectiveGravity *= 0.35; } // sustain jump while held
  unicorn.dy += effectiveGravity;
  unicorn.y  += unicorn.dy;

  // floor
  const floorY = canvas.height - 60;
  if(unicorn.y + unicorn.h >= floorY){
    unicorn.y = floorY - unicorn.h;
    unicorn.dy = 0;
    unicorn.grounded = true;
    unicorn.jumping = false;
  } else {
    unicorn.grounded = false;
  }

  // draw unicorn
  ctx.drawImage(unicornImg, unicorn.x, unicorn.y, unicorn.w, unicorn.h);

  // spawn cadence
  ringTimer += dt; fireTimer += dt;
  if(ringTimer > 1400){ spawnRing(); ringTimer = 0; }
  if(fireTimer > 2000){ spawnFireball(); fireTimer = 0; }

  // rings
  for(let i=rings.length-1;i>=0;i--){
    const r = rings[i]; r.x -= r.s;
    ctx.drawImage(ringImg, r.x, r.y, r.w, r.h);
    if(collide(unicorn, r)){ rings.splice(i,1); score += 10; }
    else if(r.x + r.w < -10){ rings.splice(i,1); }
  }

  // fireballs
  for(let i=fireballs.length-1;i>=0;i--){
    const f = fireballs[i]; f.x -= f.s;
    ctx.drawImage(fireImg, f.x, f.y, f.w, f.h);
    if(collide(unicorn, f)){ gameOver = true; }
    else if(f.x + f.w < -10){ fireballs.splice(i,1); }
  }

  // score
  ctx.fillStyle = "#000"; ctx.font = "24px Arial";
  ctx.fillText("Score: " + score, 20, 40);

  if(gameOver){
    ctx.fillStyle = "rgba(0,0,0,.55)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = "#fff"; ctx.font = "bold 42px Arial";
    ctx.fillText("Game Over", canvas.width/2 - 110, canvas.height/2 - 10);
    ctx.font = "24px Arial";
    ctx.fillText("Tap or press R to restart", canvas.width/2 - 140, canvas.height/2 + 30);
  }
}

function collide(a,b){
  return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;
}

let prev = performance.now();
function loop(now){
  const dt = Math.min(50, now - prev); prev = now;
  if(!gameOver) update(dt);
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

// Restart
addEventListener('keydown', e=>{ if(gameOver && e.code==='KeyR'){ location.reload(); } });
addEventListener('touchstart', ()=>{ if(gameOver){ location.reload(); } }, {passive:false});
</script>
</body>
</html>
